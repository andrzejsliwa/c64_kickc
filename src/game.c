
#include <c64.h>
#include <6502.h>

byte* SCREEN   = $0400;
byte* CHARSET  = $2000;
byte* SPRITE_1 = $2100;
const byte MAX_CHARS = 4;

byte* SPR_PTR = SCREEN + (40*25) + 16;

void main() {
    *VIC_MEMORY = toD018(SCREEN, CHARSET);

    *BG_COLOR = PINK;
    *BORDER_COLOR = PINK;

    *SPRITES_ENABLE = %00000001;
    *SPRITES_XPOS = 55;
    *SPRITES_YPOS = 55;
    SPR_PTR[0] = $2100 / 64;
    buildSprite(sprite1);


    initChar();
    initColorMap();
    initScreen();

    BREAK();
    while(true);
}

void initScreen() {
    for(word i=0; i<40*25; i++) {
        SCREEN[i] = level[i];
    }
}

void initColorMap() {
    for(word i=0; i<40*25; i++) {
        COLS[i] = PURPLE;
    }
}

void initChar() {
    for (char i: 0..MAX_CHARS * 8) {
        CHARSET[i] = tiles[i];
    }
}

void buildSprite(byte *spr) {
    for (char i: 0..63) {
        SPRITE_1[i] = spr[i];
    }
}


byte tiles[MAX_CHARS*8] = {
    %00000000,
    %00000000,
    %00000000,
    %00000000,
    %00000000,
    %00000000,
    %00000000,
    %00000000,

    %01111110,
    %10101011,
    %10010111,
    %10101011,
    %10010111,
    %10101011,
    %10111111,
    %01111110,

    %00000000,
    %00000000,
    %01000000,
    %01001100,
    %00110000,
    %00110100,
    %00011000,
    %00011000,

    %00000000,
    %00011100,
    %00100010,
    %00100010,
    %00011100,
    %00000100,
    %00001100,
    %00000100
};

byte sprite1[3*21] = {
    %00000000,%00000000,%00000000,
    %00000000,%00111100,%00000000,
    %00000000,%01111110,%00000000,
    %00000000,%11011011,%00000000,
    %00000000,%11011011,%00000000,
    %00000000,%11111111,%00000000,
    %00000000,%11111111,%00000000,
    %00000000,%01111110,%00000000,
    %00000000,%00111100,%00000000,
    %00000000,%00011000,%00000000,
    %00000000,%00111100,%00000000,
    %00000000,%01111110,%00000000,
    %00000000,%11011011,%00000000,
    %00000011,%10011001,%11000000,
    %00000111,%00011000,%11100000,
    %00000010,%00111100,%01000000,
    %00000000,%01100110,%00000000,
    %00000000,%11000011,%00000000,
    %00000000,%11000011,%00000000,
    %00000000,%11000011,%00000000,
    %00000001,%10000001,%10000000,
};

byte level[40*25] = {
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,3,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,
  1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
};